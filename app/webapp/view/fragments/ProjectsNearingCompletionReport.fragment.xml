<core:FragmentDefinition xmlns:core="sap.ui.core"
                         xmlns="sap.m"
                         xmlns:f="sap.ui.layout.form"
                         xmlns:mdc="sap.ui.mdc"
                         xmlns:mdct="sap.ui.mdc.table"
                         xmlns:layout="sap.f">
    <layout:DynamicPage
        id="projectsNearingCompletionReportDynamicPage"
        fitContent="false"
        preserveHeaderStateOnScroll="false"
        headerExpanded="true"
        toggleHeaderOnTitleClick="false">
        
        <layout:title>
            <layout:DynamicPageTitle>
                <layout:heading>
                    <Title text="Projects Nearing Completion Report" level="H2" />
                </layout:heading>
            </layout:DynamicPageTitle>
        </layout:title>
        
        <layout:header>
            <layout:DynamicPageHeader pinnable="false">
                <VBox class="sapUiTinyMargin">
                    <mdc:FilterBar
                        id="projectsNearingCompletionReportFilterBar"
                        delegate='{
                            "name": "glassboard/delegate/ProjectsNearingCompletionReportFilterBarDelegate",
                            "payload": {
                                "collectionPath": "ProjectsNearingCompletionReport"
                            }
                        }'
                        search="onFilterSearch"
                        showAdaptFiltersButton="true"
                        showGoButton="true"
                        showRestoreButton="true"
                        showVariantManagement="true"
                        variantBackreference="projectsNearingCompletionReportFilterBar"
                        filterConditions="{filterModel>/ProjectsNearingCompletionReport/conditions}"
                        p13nMode="Item,Value">
                        <!-- Static filter items - Default filters -->
                        <mdc:filterItems>
                            <!-- Project Name Filter -->
                            <mdc:FilterField
                                id="filterProjectsCompletionProjectName"
                                label="Project Name"
                                conditions="{filterModel>/ProjectsNearingCompletionReport/conditions/projectName}"
                                propertyKey="projectName"
                                maxConditions="-1"
                                required="false"
                                caseSensitive="false"
                                width="250px"
                                delegate='{
                                    "name": "sap/ui/mdc/field/FieldBaseDelegate",
                                    "payload": {}
                                }'
                            />
                            <!-- Completion Risk Filter -->
                            <mdc:FilterField
                                id="filterProjectsCompletionRisk"
                                label="Completion Risk"
                                conditions="{filterModel>/ProjectsNearingCompletionReport/conditions/completionRisk}"
                                propertyKey="completionRisk"
                                maxConditions="-1"
                                required="false"
                                caseSensitive="false"
                                width="200px"
                                delegate='{
                                    "name": "sap/ui/mdc/field/FieldBaseDelegate",
                                    "payload": {}
                                }'
                            />
                            <!-- Customer Filter -->
                            <mdc:FilterField
                                id="filterProjectsCompletionCustomer"
                                label="Customer"
                                conditions="{filterModel>/ProjectsNearingCompletionReport/conditions/customer}"
                                propertyKey="customer"
                                maxConditions="-1"
                                required="false"
                                caseSensitive="false"
                                width="250px"
                                delegate='{
                                    "name": "sap/ui/mdc/field/FieldBaseDelegate",
                                    "payload": {}
                                }'
                            />
                        </mdc:filterItems>
                    </mdc:FilterBar>
                </VBox>
            </layout:DynamicPageHeader>
        </layout:header>
        
        <layout:content>
            <VBox class="sapUiSmallMargin">
                <Panel class="sapUiResponsiveMargin" expandable="false">
                    <ScrollContainer height="600px" vertical="true" horizontal="false">
                        <mdc:Table
                            id="ProjectsNearingCompletionReportTable"
                            header="Projects Nearing Completion Report"
                            class="verticalsTable rowDetailToggleTable"
                            autoBindOnInit="true"
                            busyIndicatorDelay="0"
                            width="100%"
                            p13nMode="Column,Sort,Filter,Group"
                            selectionMode="None"
                            delegate='{
                                "name": "glassboard/delegate/ProjectsNearingCompletionReportTableDelegate",
                                "payload": {
                                    "collectionPath": "ProjectsNearingCompletionReport"
                                }
                            }'
                            showRowCount="true"
                            threshold="20"
                            enableExport="true"
                            enableAutoColumnWidth="false"
                            filter="projectsNearingCompletionReportFilterBar"
                            filterConditions="{filterModel>/ProjectsNearingCompletionReport/conditions}">
                            
                            <mdc:type>
                                <mdct:ResponsiveTableType />
                            </mdc:type>
                            <mdc:actions>
                                <SegmentedButton 
                                    selectedKey="less"
                                    selectionChange="onToggleRowDetail"
                                    tooltip="Toggle Row Details">
                                    <items>
                                        <SegmentedButtonItem key="more" icon="sap-icon://detail-more" tooltip="Show More"/>
                                        <SegmentedButtonItem key="less" icon="sap-icon://detail-less" tooltip="Show Less"/>
                                    </items>
                                </SegmentedButton>
                            </mdc:actions>
                        </mdc:Table>
                    </ScrollContainer>
                </Panel>
            </VBox>
        </layout:content>
    </layout:DynamicPage>
</core:FragmentDefinition>

