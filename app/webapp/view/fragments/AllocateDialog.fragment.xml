<core:FragmentDefinition
  xmlns="sap.m" 
  xmlns:core="sap.ui.core"
  xmlns:f="sap.ui.layout.form">

  <Dialog
    id="allocateDialog"
    title="Allocate Resource"
    draggable="true"
    resizable="true"
    contentWidth="800px"
    contentHeight="600px"
    class="sapUiResponsivePadding--header sapUiResponsivePadding--content sapUiResponsivePadding--footer"
    afterClose="onDialogClose">

    <VBox>
      <Label text="Project" labelFor="Resinput_proj"/>
      <Input 
        id="Resinput_proj" 
        width="100%"
        placeholder="Select project"
        showValueHelp="true"
        valueHelpRequest="onProjectValueHelpRequest">
        <layoutData>
          <f:ColumnElementData cellsSmall="12" cellsLarge="12" />
        </layoutData>
      </Input>

      <Label text="Demand" labelFor="Resinput_demand"/>
      <Input 
        id="Resinput_demand" 
        width="100%"
        placeholder="Select Demand"
        showValueHelp="true"
        valueHelpRequest="onDemandValueHelpRequest">
        <layoutData>
          <f:ColumnElementData cellsSmall="12" cellsLarge="12" />
        </layoutData>
      </Input>

      <Label text="From" labelFor="startDate"/>
      <DatePicker id="startDate" valueFormat="yyyy-MM-dd" displayFormat="long" enabled="true" editable="true"/>

      <Label text="To" labelFor="endDate"/>
      <DatePicker id="endDate" valueFormat="yyyy-MM-dd" displayFormat="long" enabled="true" editable="true"/>
      
      <Label text="Allocation %" labelFor="allocationPercentage_allocate"/>
      <Input 
        id="allocationPercentage_allocate" 
        type="Number"
        value="100"
        placeholder="0-100"
        width="100%"/>
      
      <!-- ✅ NEW: Panel to show selected employees' allocation details -->
      <Panel 
        id="selectedEmployeesAllocationPanel" 
        headerText="Selected Employees' Current Allocations" 
        expandable="true"
        expanded="false"
        class="sapUiSmallMarginTop">
        <VBox id="selectedEmployeesAllocationVBox" class="sapUiSmallMargin">
          <Text text="Select employees from the table first" />
        </VBox>
      </Panel>
      
      <!-- ✅ NEW: Panel to show employees allocated to selected project -->
      <Panel 
        id="projectEmployeesPanel" 
        headerText="Employees Allocated to Selected Project" 
        expandable="true"
        expanded="false"
        class="sapUiSmallMarginTop">
        <VBox id="projectEmployeesVBox" class="sapUiSmallMargin">
          <Text text="Select a project to see allocated employees" />
        </VBox>
      </Panel>
    </VBox>

    <beginButton>
      <Button text="Allocate" type="Emphasized" press="onAllocateConfirm"/>
    </beginButton>

    <endButton>
      <Button icon="sap-icon://decline" press="onDialogClose"/>
    </endButton>
  </Dialog>
</core:FragmentDefinition>
